clear all
clc
methane = [-0.703029 108.4773 -42.52157 5.862788  0.678565 85.81217 11.26467 -2.114146 0.138190 -26.42221 0 0 0 0 0 1300 6000];
CO2 = [24.99735 55.18696 -33.69137 7.948387 -0.136638 58.16639 2.720074 -0.492289 0.038844 -6.447293 0 0 0 0 0 1200 6000];
Water = [30.09200 6.832514 6.793435 -2.534480	 0.082139 41.96426 8.622053 -1.499780 0.098119 -11.15764 0 0 0 0 0 1700 6000];
Oxygen=[31.32234 -20.23531 57.86644 -36.50624 -0.007374 30.03235 8.772972 -3.988133 0.788313 -0.741599 23.245 10.72071 -2.020498 0.146449 9.245722 700 2000];
Nitrogen = [28.98641 1.853978  -9.647459 16.63537 0.000117 19.50583 19.88705 -8.598535 1.369784 0.527601 35.51872 1.128728 -0.196103 0.014662 -4.553760 500 2000];
CO = [25.56759 6.096130 4.054656 -2.671301 0.131021 0 0 0 0 0 0 0 0 0 0 6000 0];
hydrogen = [33.066178 -11.363417 11.432816 -2.772854 -0.158558 0 0 0 0 0 0 0 0 0 0 6000 0];
delHo=1e+07.*[0 0 0 0];
species = [CO;CO2;hydrogen;methane];
MM = [28 44 2 16];
P1=17.5;%bar
P4=80;%bar
T3=40+273.15; %K
T1=T3;
gamma=1.5;
F0=1043.262451/(3600); %kmol/s
beta=P4/P1;
beta_sing_stadio=sqrt(beta);
T2=beta_sing_stadio^((gamma-1)/gamma)*T1;
T4=T2;
y_in=[0.1544 0.0802 0.7288 0.0366];
F_in=F0.*y_in;
m_in_kgs = F_in*MM'
intcp = zeros(1,4);
th = thermo_funs;
for i=1:4
    intcp(i) = th.delh(species(i,:),delHo(i),T2,'NIST')-th.delh(species(i,:),delHo(i),T1,'NIST');
end
L=2*intcp.*F_in;
L_compressori_MW=sum(L)/10^6
L_turbine = L_compressori_MW*1.5
